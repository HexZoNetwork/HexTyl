# Include this file inside your HTTPS server block:
#   include /etc/nginx/snippets/hextyl-antiddos.conf;
# and keep profile include managed by installer:
#   /etc/nginx/snippets/hextyl-antiddos-profile.conf

# Connection controls (shared across all profiles)
limit_conn perip_conn 30;

# Profile-specific rate limit rules are loaded from:
include /etc/nginx/snippets/hextyl-antiddos-profile.conf;

# Slowloris hardening
client_header_timeout 10s;
client_body_timeout 10s;
send_timeout 10s;
keepalive_timeout 15s;
reset_timedout_connection on;

# Optional bot trap endpoint
location = /api/admin/debug {
    access_log /var/log/nginx/honeypot_access.log combined;
    return 403;
}
